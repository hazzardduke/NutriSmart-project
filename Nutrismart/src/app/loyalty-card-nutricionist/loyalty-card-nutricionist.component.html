<!-- src/app/features/loyalty-card-nutricionist/loyalty-card-nutricionist.component.html -->
<div class="nutri-wrapper">
  <h2>Administrar Tarjetas de Fidelidad</h2>

  <!-- PESTAÑAS -->
  <ul class="tabs" role="tablist">
    <li
      role="tab"
      [attr.aria-selected]="activeTab==='manage'"
      [class.active]="activeTab==='manage'"
      (click)="switchTab('manage')"
      tabindex="0"
    >
      Gestionar sellos
    </li>
    <li
      role="tab"
      [attr.aria-selected]="activeTab==='overview'"
      [class.active]="activeTab==='overview'"
      (click)="switchTab('overview')"
      tabindex="0"
    >
      Resumen de sellos
    </li>
  </ul>

  <!-- TAB 1: GESTIONAR -->
  <section *ngIf="activeTab==='manage'" class="manage-tab" role="tabpanel">
    <div *ngIf="successMessage" class="info-message">
      {{ successMessage }}
    </div>

    <div class="form-group">
      <label for="cliente-select">Seleccione Cliente</label>
      <div class="input-group">
        <select
          id="cliente-select"
          [(ngModel)]="selectedId"
          class="cliente-select"
        >
          <option value="">— ninguno —</option>
          <option
            *ngFor="let c of clients$ | async"
            [value]="c.uid"
          >
            {{ c.nombre }} {{ c.apellidos }} ({{ c.cedula }})
          </option>
        </select>

        <button
          type="button"
          class="btn add-stamp"
          (click)="addStamp()"
          [disabled]="!selectedId"
        >
          Añadir sello
        </button>
      </div>
    </div>
  </section>

  <!-- TAB 2: RESUMEN -->
  <section *ngIf="activeTab==='overview'" class="overview-tab" role="tabpanel">
    <table class="summary-table">
      <thead>
        <tr>
          <th>Cliente</th>
          <th>Sellos</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of overview$ | async">
          <td>{{ c.nombre }} {{ c.apellidos }}</td>
          <td class="stamps-cell">
            <span class="stamps-badge">{{ c.stamps }} / 7</span>
          </td>
        </tr>
        <tr *ngIf="(overview$ | async)?.length === 0">
          <td colspan="2" class="no-data">No hay registros aún.</td>
        </tr>
      </tbody>
    </table>
  </section>
</div>
